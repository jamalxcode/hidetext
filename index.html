<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emoji Steganography - Hide Secret Messages</title>
    <meta name="description" content="Hide secret messages inside emoji using invisible Unicode variation selectors. Encode and decode text with this steganography tool.">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(135deg, #0a0a0f, #1a1a2e, #0a0a0f);
            color: #f7fafc; 
            min-height: 100vh; 
            line-height: 1.5;
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 24px; }
        .header { text-align: center; margin-bottom: 32px; }
        .title { 
            font-size: 2.5rem; 
            font-weight: bold; 
            background: linear-gradient(135deg, #8b5cf6, #3b82f6);
            -webkit-background-clip: text; 
            background-clip: text; 
            -webkit-text-fill-color: transparent; 
            margin-bottom: 8px; 
        }
        .subtitle { color: #9ca3af; font-size: 1.125rem; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 32px; margin-bottom: 32px; }
        @media (max-width: 1024px) { .grid { grid-template-columns: 1fr; } }
        .card { 
            background: linear-gradient(145deg, #1f2937, #374151);
            border: 1px solid #4b5563; 
            border-radius: 12px; 
            padding: 24px; 
            box-shadow: 0 4px 24px rgba(0,0,0,0.4);
        }
        .card-header { display: flex; align-items: center; gap: 8px; margin-bottom: 24px; }
        .card-title { font-size: 1.5rem; font-weight: 600; }
        .emoji-grid { 
            display: grid; 
            grid-template-columns: repeat(8, 1fr); 
            gap: 8px; 
            margin-bottom: 24px; 
        }
        @media (min-width: 640px) { .emoji-grid { grid-template-columns: repeat(12, 1fr); } }
        .emoji-btn { 
            width: 40px; height: 40px; 
            border: 1px solid #4b5563; 
            background: transparent; 
            border-radius: 8px; 
            font-size: 18px; 
            cursor: pointer; 
            transition: all 0.3s;
        }
        .emoji-btn:hover { background: #374151; transform: scale(1.1); }
        .emoji-btn.selected { 
            background: linear-gradient(135deg, #8b5cf6, #3b82f6);
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.3);
        }
        .form-group { margin-bottom: 24px; }
        .label { display: block; font-size: 0.875rem; font-weight: 500; margin-bottom: 8px; }
        .textarea, .input { 
            width: 100%; 
            padding: 12px; 
            background: #1f2937; 
            border: 1px solid #4b5563; 
            border-radius: 8px; 
            color: #f7fafc; 
            font-family: inherit; 
            resize: vertical;
        }
        .textarea { min-height: 100px; }
        .textarea:focus, .input:focus { 
            outline: none; 
            border-color: #8b5cf6; 
            box-shadow: 0 0 0 2px rgba(139, 92, 246, 0.2);
        }
        .btn-group { display: flex; flex-wrap: wrap; gap: 12px; margin-bottom: 24px; }
        .btn { 
            padding: 8px 16px; 
            border: none; 
            border-radius: 8px; 
            font-weight: 500; 
            cursor: pointer; 
            transition: all 0.3s;
        }
        .btn-primary { 
            background: linear-gradient(135deg, #8b5cf6, #3b82f6); 
            color: white; 
        }
        .btn-primary:hover { box-shadow: 0 0 20px rgba(139, 92, 246, 0.3); }
        .btn-outline { 
            background: transparent; 
            border: 1px solid #4b5563; 
            color: #f7fafc; 
        }
        .btn-outline:hover { background: #374151; }
        .btn-ghost { background: transparent; color: #9ca3af; }
        .btn-ghost:hover { background: #374151; color: #f7fafc; }
        .btn-decode { border: 1px solid #10b981; color: #10b981; }
        .btn-decode:hover { background: rgba(16, 185, 129, 0.1); }
        .result-card { 
            background: linear-gradient(90deg, rgba(139, 92, 246, 0.1), rgba(16, 185, 129, 0.1));
            border: 1px solid rgba(75, 85, 99, 0.3); 
            border-radius: 8px; 
            padding: 16px; 
            margin-top: 16px;
        }
        .result-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .result-input { 
            font-family: 'Courier New', monospace; 
            background: #1f2937; 
            border: 1px solid #4b5563; 
            padding: 8px; 
            border-radius: 4px; 
            width: 100%; 
            color: #f7fafc;
        }
        .stats { color: #10b981; font-size: 0.875rem; margin-top: 8px; }
        .debug-info { margin-top: 16px; font-size: 0.75rem; }
        .debug-header { color: #3b82f6; margin-bottom: 8px; }
        .debug-item { color: #9ca3af; font-family: 'Courier New', monospace; margin-left: 20px; }
        .decoded-result { 
            background: #1f2937; 
            border: 1px solid #4b5563; 
            padding: 12px; 
            border-radius: 4px; 
            font-family: 'Courier New', monospace; 
            color: #10b981;
        }
        .help-section { 
            background: linear-gradient(145deg, #1f2937, #374151);
            border: 1px solid #4b5563; 
            border-radius: 12px; 
            padding: 24px;
        }
        .help-header { display: flex; align-items: center; gap: 8px; margin-bottom: 16px; }
        .help-content { font-size: 0.875rem; color: #9ca3af; line-height: 1.6; }
        .help-content p { margin-bottom: 16px; }
        .help-link { color: #3b82f6; text-decoration: none; }
        .help-link:hover { color: #8b5cf6; }
        .toast { 
            position: fixed; 
            top: 20px; 
            right: 20px; 
            background: #1f2937; 
            border: 1px solid #4b5563; 
            border-radius: 8px; 
            padding: 16px; 
            box-shadow: 0 8px 32px rgba(0,0,0,0.6);
            transform: translateX(100%); 
            transition: transform 0.3s; 
            z-index: 1000; 
            max-width: 300px;
        }
        .toast.show { transform: translateX(0); }
        .toast-title { font-weight: 600; margin-bottom: 4px; }
        .toast-description { font-size: 0.875rem; color: #9ca3af; }
        .toast-error { border-color: #dc2626; }
        .ml-auto { margin-left: auto; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">Emoji Steganography</h1>
            <p class="subtitle">Hide secret messages inside emoji using invisible Unicode variation selectors</p>
        </div>

        <div class="grid">
            <!-- Encode Pane -->
            <div class="card">
                <div class="card-header">
                    <span style="color: #8b5cf6;">‚ö°</span>
                    <h2 class="card-title">Encode</h2>
                </div>

                <div class="form-group">
                    <label class="label">Select Carrier Emoji</label>
                    <div class="emoji-grid" id="emojiGrid"></div>
                </div>

                <div class="form-group">
                    <label class="label">Secret Message</label>
                    <textarea class="textarea" id="secretMessage" placeholder="Enter your secret message here..."></textarea>
                </div>

                <div class="btn-group">
                    <button class="btn btn-primary" onclick="handleEncode()">‚ú® Encode</button>
                    <button class="btn btn-outline" onclick="clearEncode()">Clear</button>
                    <button class="btn btn-ghost ml-auto" onclick="toggleDebug()" id="debugBtn">üëÅ Show Debug</button>
                </div>

                <div id="encodeResult" class="hidden">
                    <div class="result-card">
                        <div class="result-header">
                            <label class="label">Emoji with Hidden Data</label>
                            <button class="btn btn-ghost" onclick="copyResult()" style="padding: 4px 8px;">üìã</button>
                        </div>
                        <input class="result-input" id="encodedEmoji" readonly>
                        <div class="stats" id="encodeStats"></div>
                        <div id="debugInfo" class="debug-info hidden">
                            <div class="debug-header">Debug Info:</div>
                            <div id="debugList"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Decode Pane -->
            <div class="card">
                <div class="card-header">
                    <span style="color: #10b981;">üëÅ</span>
                    <h2 class="card-title">Decode</h2>
                </div>

                <div class="form-group">
                    <label class="label">Paste Emoji with Hidden Data</label>
                    <textarea class="textarea" id="inputToDecode" placeholder="Paste the emoji with hidden message here..."></textarea>
                </div>

                <div class="btn-group">
                    <button class="btn btn-decode" onclick="handleDecode()">üëÅ Decode</button>
                    <button class="btn btn-ghost" onclick="clearDecode()">Clear</button>
                </div>

                <div id="decodeResult" class="hidden">
                    <div class="result-card">
                        <label class="label">Decoded Message</label>
                        <div class="decoded-result" id="decodedMessage"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Help Section -->
        <div class="help-section">
            <div class="help-header">
                <span style="color: #3b82f6;">‚ÑπÔ∏è</span>
                <h3 style="font-size: 1.125rem; font-weight: 600;">How It Works</h3>
            </div>
            
            <div class="help-content">
                <p>This tool hides secret messages inside emoji by using invisible Unicode variation selectors. These are special characters that modify the appearance of emoji but are often preserved when copying and pasting.</p>
                
                <p><strong style="color: #f7fafc">Note:</strong> Some applications and platforms may strip these invisible characters, so the hidden data might not survive all transfers. This technique works best in environments that preserve Unicode formatting.</p>
                
                <div style="padding-top: 8px;">
                    <a href="https://paulbutler.org/2025/smuggling-arbitrary-data-through-an-emoji/" target="_blank" rel="noopener noreferrer" class="help-link">üîó Learn more about this technique</a>
                </div>
                
                <p style="border-top: 1px solid rgba(75, 85, 99, 0.3); padding-top: 12px; margin-top: 16px; font-size: 0.75rem;"><strong>Disclaimer:</strong> This tool is for educational purposes. Always respect privacy and security policies when handling data.</p>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast" class="toast">
        <div class="toast-title" id="toastTitle"></div>
        <div class="toast-description" id="toastDescription"></div>
    </div>

    <script>
        const COMMON_EMOJIS = ['üòÄ', 'üòç', 'üî•', '‚ù§Ô∏è', 'üëç', 'üòÇ', 'üéâ', '‚ú®', 'üíØ', 'üöÄ', '‚≠ê', 'üåü', 'üíé', 'üé®', 'üéµ', 'üì±', 'üíª', 'üåà', '‚òÄÔ∏è', 'üåô', '‚ö°', 'üîÆ', 'üéØ', 'üèÜ'];
        let selectedEmoji = 'üòÄ';
        let debugMode = false;

        function initializeEmojiPicker() {
            const emojiGrid = document.getElementById('emojiGrid');
            COMMON_EMOJIS.forEach(emoji => {
                const btn = document.createElement('button');
                btn.className = `emoji-btn ${emoji === selectedEmoji ? 'selected' : ''}`;
                btn.textContent = emoji;
                btn.onclick = () => selectEmoji(emoji);
                emojiGrid.appendChild(btn);
            });
        }

        function selectEmoji(emoji) {
            selectedEmoji = emoji;
            document.querySelectorAll('.emoji-btn').forEach(btn => {
                btn.className = btn.textContent === emoji ? 'emoji-btn selected' : 'emoji-btn';
            });
        }

        function encodeMessage(message, baseEmoji) {
            const utf8Bytes = new TextEncoder().encode(message);
            const selectors = [];
            const debugInfo = [];

            for (const byte of utf8Bytes) {
                let selector = byte <= 15 ? 0xFE00 + byte : 0xE0100 + (byte - 16);
                selectors.push(selector);
                debugInfo.push(`Byte ${byte} ‚Üí U+${selector.toString(16).toUpperCase()}`);
            }

            const selectorString = selectors.map(s => String.fromCodePoint(s)).join('');
            return {
                encodedEmoji: baseEmoji + selectorString,
                bytes: utf8Bytes.length,
                debugInfo: debugMode ? debugInfo : undefined
            };
        }

        function decodeMessage(input) {
            const codePoints = Array.from(input).map(char => char.codePointAt(0));
            let baseIndex = codePoints.findIndex(cp => cp > 127);
            if (baseIndex === -1) return '';

            const selectors = codePoints.slice(baseIndex + 1);
            if (selectors.length === 0) return '';

            const bytes = [];
            for (const selector of selectors) {
                let byte;
                if (selector >= 0xFE00 && selector <= 0xFE0F) {
                    byte = selector - 0xFE00;
                } else if (selector >= 0xE0100 && selector <= 0xE01EF) {
                    byte = (selector - 0xE0100) + 16;
                } else continue;
                bytes.push(byte);
            }

            if (bytes.length === 0) return '';

            try {
                return new TextDecoder('utf-8', { fatal: true }).decode(new Uint8Array(bytes));
            } catch {
                return '';
            }
        }

        function handleEncode() {
            const message = document.getElementById('secretMessage').value;
            if (!message.trim()) {
                showToast('No message to encode', 'Please enter a secret message first.', 'error');
                return;
            }

            if (message.length > 10000) {
                showToast('Message too long', 'Message may be too long for stable transfer.', 'error');
            }

            const result = encodeMessage(message, selectedEmoji);
            document.getElementById('encodedEmoji').value = result.encodedEmoji;
            document.getElementById('encodeStats').textContent = `${result.bytes} bytes hidden`;
            
            if (debugMode && result.debugInfo) {
                document.getElementById('debugList').innerHTML = result.debugInfo.map(info => `<div class="debug-item">${info}</div>`).join('');
                document.getElementById('debugInfo').classList.remove('hidden');
            } else {
                document.getElementById('debugInfo').classList.add('hidden');
            }

            document.getElementById('encodeResult').classList.remove('hidden');
            showToast('Message encoded!', `Hidden ${result.bytes} bytes in emoji.`);
        }

        function handleDecode() {
            const input = document.getElementById('inputToDecode').value;
            if (!input.trim()) {
                showToast('No input to decode', 'Please paste emoji with hidden data first.', 'error');
                return;
            }

            const decoded = decodeMessage(input);
            if (decoded) {
                document.getElementById('decodedMessage').textContent = decoded;
                document.getElementById('decodeResult').classList.remove('hidden');
                showToast('Message decoded!', 'Successfully extracted hidden message.');
            } else {
                document.getElementById('decodeResult').classList.add('hidden');
                showToast('No hidden data found', 'No hidden data detected in the input.', 'error');
            }
        }

        async function copyResult() {
            const text = document.getElementById('encodedEmoji').value;
            try {
                await navigator.clipboard.writeText(text);
                showToast('Copied!', 'Encoded result copied to clipboard.');
            } catch {
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showToast('Copied!', 'Encoded result copied to clipboard.');
            }
        }

        function clearEncode() {
            document.getElementById('secretMessage').value = '';
            document.getElementById('encodeResult').classList.add('hidden');
        }

        function clearDecode() {
            document.getElementById('inputToDecode').value = '';
            document.getElementById('decodeResult').classList.add('hidden');
        }

        function toggleDebug() {
            debugMode = !debugMode;
            document.getElementById('debugBtn').textContent = debugMode ? 'üôà Hide Debug' : 'üëÅ Show Debug';
        }

        function showToast(title, description, type = 'success') {
            const toast = document.getElementById('toast');
            document.getElementById('toastTitle').textContent = title;
            document.getElementById('toastDescription').textContent = description;
            toast.className = `toast ${type === 'error' ? 'toast-error' : ''}`;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        document.addEventListener('DOMContentLoaded', initializeEmojiPicker);
    </script>
</body>
</html>
